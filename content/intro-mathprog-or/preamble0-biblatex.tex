%%% BibLaTeX setup --> see also
%%% /open-optimization-bibliography/test/bibliography-biblatex.tex.

\usepackage{csquotes}   % to work around a bug in pre-2018 biblatex, https://github.com/plk/biblatex/issues/737
\usepackage[backend=biber,giveninits=true,maxnames=100,maxcitenames=5,sorting=nyt,backref=true]{biblatex}
\addbibresource{../../../open-optimization-bibliography/bib/references.bib}
\addbibresource{../../figures/figures-static/00_METADATA.bib}

% print url only if no doi.  https://tex.stackexchange.com/questions/424774/print-url-only-if-doi-not-present
%% \renewbibmacro*{doi+eprint+url}{%
%%     \printfield{doi}%
%%     \newunit\newblock%
%%     \iftoggle{bbx:eprint}{%
%%         \usebibmacro{eprint}%
%%     }{}%
%%     \newunit\newblock%
%%     \iffieldundef{doi}{%
%%         \usebibmacro{url+urldate}}%
%%         {}%
%%     }
% print url&eprint only if no doi. Adapted from above.
\renewbibmacro*{doi+eprint+url}{%
    \printfield{doi}%
    \newunit\newblock%
    \iffieldundef{doi}{%
      \iftoggle{bbx:eprint}{%
        \usebibmacro{eprint}%
      }{}%
    }{}%
    \newunit\newblock%
    \iffieldundef{doi}{%
        \usebibmacro{url+urldate}}%
        {}%
    }


\DeclareRobustCommand\footnotetextmetadata[1]{%
  \footnotetext{\citetitle*{#1}, from \citeurl{#1}.
    \citeauthor{#1}, \citedate{#1}.
  }
}

\usepackage{xargs}
\newcommandx{\refincludefigurestatic}[3][1=\relax,2={width=.4\linewidth},usedefault]{%
  \begin{figure}[t]%
    \centering%
    \includegraphics[#2]{../../figures/figures-static/#3}%
    \caption{%
      \ifx#1\relax % Caption from TITLE field in .bib
      \citetitle*{#3}%
      \else        % Caption provided as an argument to the macro
      #1%
      \fi%
      \protect\footnotemark}%
    \label{fig:#3}%
  \end{figure}%
  \autoref{fig:#3}\footnotetextmetadata{#3}%
}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "open-optimization/open-optimization"
%%% End:
